public class DigitalFilters
{
    // Used for filtering 16kHz down to 8kHz. Fstop is 4kHz
    private static final double[] lowpass_8k = new double[] {
            0.004107475681421,  0.02333483941182, 0.004297307448838,-0.001739162251989,
            -0.003062118265377, 0.001833831978175, 0.002215802625304,-0.001832855098479,
            -0.001984720463481, 0.001880798308636, 0.001939162120181,-0.001928979353986,
            -0.001983127885456, 0.001969678123036,  0.00207930546545,-0.002001190918542,
            -0.002207768441941, 0.002023700329109, 0.002360190169781,-0.002039123246802,
            -0.002534165713242, 0.002042782783106, 0.002721043047481,-0.002038262299179,
            -0.002924897634582, 0.002022479440659, 0.003140454433307,-0.001995263848649,
            -0.003369415263144, 0.001956126934387, 0.003610837670472,-0.001903278333997,
            -0.003865975614946, 0.001836942024095, 0.004135722611827,-0.001755491923376,
            -0.004419379276132, 0.001660814371083,  0.00471937755204,-0.001549051865212,
            -0.005032622139562, 0.001420029659568, 0.005362411113878,-0.001270731382089,
            -0.005708860117181, 0.001096163066426, 0.006077278887983,-0.0008984135570158,
            -0.006466859084448,0.0006728754673783, 0.006883435420327,-0.000422586012181,
            -0.007325429312888, 0.000131030888747, 0.007784990045841, 0.000186315069385,
            -0.008305175876907,-0.0005782495775835, 0.008837914765242,0.0009940210360832,
            -0.009427998947814,-0.001462685070763,  0.01007918615064, 0.002013342760894,
            -0.01080474351669,-0.002651534095534,  0.01161956669087, 0.003387948513042,
            -0.01253090275647,-0.004267927162332,  0.01358898203956, 0.005300424527334,
            -0.01481734185776,-0.006554114798989,   0.0163004567918, 0.008105459515639,
            -0.01811346179335,  -0.0100651732138,  0.02042102893016,  0.01263554228593,
            -0.02347110940646, -0.01615741555197,  0.02773863213942,  0.02130034496626,
            -0.03420083637395,  -0.0295532276073,  0.04525442251565,  0.04505417040653,
            -0.06877606139057, -0.08518453050043,   0.1546519252177,   0.4454317154424,
            0.4454317154424,   0.1546519252177, -0.08518453050043, -0.06877606139057,
            0.04505417040653,  0.04525442251565,  -0.0295532276073, -0.03420083637395,
            0.02130034496626,  0.02773863213942, -0.01615741555197, -0.02347110940646,
            0.01263554228593,  0.02042102893016,  -0.0100651732138, -0.01811346179335,
            0.008105459515639,   0.0163004567918,-0.006554114798989, -0.01481734185776,
            0.005300424527334,  0.01358898203956,-0.004267927162332, -0.01253090275647,
            0.003387948513042,  0.01161956669087,-0.002651534095534, -0.01080474351669,
            0.002013342760894,  0.01007918615064,-0.001462685070763,-0.009427998947814,
            0.0009940210360832, 0.008837914765242,-0.0005782495775835,-0.008305175876907,
            0.000186315069385, 0.007784990045841, 0.000131030888747,-0.007325429312888,
            -0.000422586012181, 0.006883435420327,0.0006728754673783,-0.006466859084448,
            -0.0008984135570158, 0.006077278887983, 0.001096163066426,-0.005708860117181,
            -0.001270731382089, 0.005362411113878, 0.001420029659568,-0.005032622139562,
            -0.001549051865212,  0.00471937755204, 0.001660814371083,-0.004419379276132,
            -0.001755491923376, 0.004135722611827, 0.001836942024095,-0.003865975614946,
            -0.001903278333997, 0.003610837670472, 0.001956126934387,-0.003369415263144,
            -0.001995263848649, 0.003140454433307, 0.002022479440659,-0.002924897634582,
            -0.002038262299179, 0.002721043047481, 0.002042782783106,-0.002534165713242,
            -0.002039123246802, 0.002360190169781, 0.002023700329109,-0.002207768441941,
            -0.002001190918542,  0.00207930546545, 0.001969678123036,-0.001983127885456,
            -0.001928979353986, 0.001939162120181, 0.001880798308636,-0.001984720463481,
            -0.001832855098479, 0.002215802625304, 0.001833831978175,-0.003062118265377,
            -0.001739162251989, 0.004297307448838,  0.02333483941182, 0.004107475681421
    };

    // Bandpass for filtering 44100kHz down to 16kHz and allowing only human speech freqs. through
    private static final double[] bandpass_16k = new double[]{
            -0.02150272516411,-0.007730992967857,-0.004200439609664,4.897548738224e-05,
            0.002122811180409, 0.001285245698351,-0.0007058348021241,-0.001553460279354,
            -0.0006300203697085,0.0007487101716253,0.0009978027936497,-1.459276108929e-05,
            -0.001012654016707,-0.0008586680779745,0.0001843095076105,0.0008619009340159,
            0.0004067627742961,-0.0006025337000374,-0.0009728895412723,-0.0002869845199696,
            0.0006272378730493,0.0006995152034379,-0.0001416156350387,-0.0008952759700453,
            -0.0006857854984845,0.0002351824726088,0.0007884515676214,0.0003398504045031,
            -0.0005922282470676,-0.000918535951082,-0.0002549374502535, 0.000635209998804,
            0.0006960687735884,-0.0001192163039461,-0.0008754192541115,-0.0006997115177725,
            0.0002327909966191, 0.000819277565379,0.0003981029005414,-0.0005613267449677,
            -0.0009355366118545,-0.0002906878027679,0.0006400627250246,0.0007752995892076,
            -4.159983599533e-05,-0.0008719377005756,-0.0007468180885898,0.0001967437535679,
            0.0008785601751685, 0.000506598535416,-0.0004917351761826,-0.0009625668540147,
            -0.0003470224773931,0.0006539565903338,0.0008884250969823,7.737424922009e-05,
            -0.0008467104533838,-0.0008174477312983, 0.000143064449299,0.0009331479693329,
            0.0006405533550184,-0.0004054467855659, -0.00099124261468,-0.0004307328547646,
            0.000640869627591,0.0009903183505023,0.0002112234245112,-0.0008103334986364,
            -0.0008804045750915,8.847585094435e-05,0.0009951662529362,0.0007911046221082,
            -0.0002963541451266,-0.001012844154203,-0.0005228098314979, 0.000624818659927,
            0.001112288115912,0.0003740172819325,-0.0007452284318538,-0.0009504685916628,
            9.173374464842e-06, 0.001040750392679, 0.000955849541291,-0.0001545054438914,
            -0.001011858494658,-0.0006172987407817,0.0005895409352301, 0.001225996935594,
            0.0005556846473875,-0.0006552526642231,-0.001007733027611,-7.997294061715e-05,
            0.001073071901619, 0.001124368591935,9.411383095182e-06,-0.000989248813609,
            -0.000712179315127,0.0005386894289782, 0.001332525630582,0.0007503892457431,
            -0.0005419160355687, -0.00105368887147,-0.0001820666339966, 0.001086757239231,
            0.001291523031235,0.0001932837727615,-0.0009485187898888,-0.0008074562481527,
            0.0004706659912408,  0.00142659300286,0.0009583933614704,-0.0004010096586872,
            -0.001084182337297,-0.0002897189544568, 0.001083599833506,  0.00145922491158,
            0.0003989432641414,-0.0008799323852014,-0.0008962587217069, 0.000386722646621,
            0.001505423704026, 0.001171363240457,-0.0002383566124884,-0.001099553955996,
            -0.0004066049191761, 0.001059864779588, 0.001619257907855,0.0006233053467681,
            -0.000786794555006,-0.0009799357305845,0.0002837007988668, 0.001562946144034,
            0.001386727109692,-4.860219563733e-05,-0.001091777149229,-0.0005268925468379,
            0.001012332601044, 0.001763195689928,0.0008573197236253,-0.0006686976588048,
            -0.001051074846744,0.0001664110523444, 0.001599128455241, 0.001599026219155,
            0.000160029178462,-0.001063635211024,-0.0006503799072428,0.0009419884988638,
            0.001891232909568, 0.001101311125526,-0.0005245627813242,-0.001110988025465,
            3.462079953838e-05, 0.001610034189391, 0.001805952340056,0.0003901943336624,
            -0.001010101112361,-0.0007729608274546,0.0008476673993606,   0.0019977879338,
            0.001351131421487,-0.0003553876318224,-0.001154784847737,-0.0001120293655498,
            0.001590729081188, 0.001998770663449,0.0006359702914323,-0.0009330229645816,
            -0.0008931039706657,0.0007275022188495, 0.002077432482601, 0.001600316665001,
            -0.000161382341586,-0.001180665464799,-0.000268894207009, 0.001542122521716,
            0.00217481402121,0.0008948555054185,-0.0008304690105332,-0.001008451135744,
            0.0005832441281812, 0.002126808893493,  0.00184550238704,5.462044923736e-05,
            -0.001185755267068,-0.0004348973290381, 0.001460854309668, 0.002327491425921,
            0.001161722365007,-0.0007024018759254,-0.001114281644621,0.0004172499015883,
            0.002144325138744, 0.002080237356164, 0.000289859042798,-0.001170209564429,
            -0.0006080825633426, 0.001347297789009, 0.002454282791398, 0.001433713409129,
            -0.000548683060316,-0.001209304369199,0.0002281928410587, 0.002124287145477,
            0.002298983764104,0.0005416988011997,-0.001131133114485,-0.0007847485843289,
            0.001198769714843, 0.002547165636547, 0.001703352037608,-0.0003711971095995,
            -0.001289133976047,2.038798429254e-05, 0.002065892673452, 0.002496103148924,
            0.0008062205022658,-0.001066626862007,-0.0009607232971101, 0.001018500447534,
            0.002603907835322, 0.001966427446464,-0.0001714913720807,-0.001351830516465,
            -0.0002042041204964, 0.001966319818918, 0.002665741286797, 0.001078934603064,
            -0.0009776325870512,-0.001133317449416,0.0008059588084943, 0.002619836627284,
            0.002217334927419,4.910911741414e-05, -0.00139459657493,-0.0004427996696732,
            0.001824200382772, 0.002802211625707, 0.001355356433184,-0.0008625639463818,
            -0.001298511715362,0.0005628978549067, 0.002591176103359, 0.002448962032239,
            0.0002866811880138,-0.001415711070507,-0.0006916848664123, 0.001639371892151,
            0.002900608348029,  0.00163061212209,-0.0007225827614733,-0.001453255880003,
            0.0002911964638295, 0.002514436733226, 0.002656047750177,0.0005388602928766,
            -0.001411281156302,-0.0009460778582013, 0.001412577491897, 0.002955873757237,
            0.001898422754825,-0.0005583641440937,-0.001592610050418,-5.001540654943e-06,
            0.002388868154202, 0.002832244561842,0.0008002456661286,-0.001382416440293,
            -0.001202796193306, 0.001144188808004, 0.002963904631466, 0.002153126000497,
            -0.0003720503258406,-0.001714677543657,-0.000322685377187, 0.002212219040436,
            0.002972423717744, 0.001067357195083,-0.001326318717331,-0.001456684845825,
            0.0008363869868532, 0.002920512312743, 0.002388546811447,-0.0001658494867988,
            -0.001814918540032,-0.0006576011235634, 0.001984152340229,  0.00306997573009,
            0.001334713539235,-0.001243110511869,-0.001702619667215, 0.000492521179174,
            0.002822638834225, 0.002598055402464,5.738478820192e-05,-0.001890684790081,
            -0.00100387894099, 0.001705833281049, 0.003120594006668, 0.001596656562541,
            -0.001132875304044,-0.001936293595966, 0.000115971513545, 0.002668323464394,
            0.002776050905555,0.0002942203066712,-0.001938982042832,-0.001356966370048,
            0.001377653290532, 0.003118495991565, 0.001846697604527,-0.0009967446947021,
            -0.00215284343431,-0.0002885566081148, 0.002456124166766, 0.002915932180707,
            0.0005403626683759,-0.001957986292545,-0.001710834683023, 0.001002782286197,
            0.003060904401584, 0.002080070531093,-0.000835302343748,-0.002347076373794,
            -0.000716388253454, 0.002185083457686, 0.003012144946458,0.0007913827948186,
            -0.001945343513852,-0.002059271433199,0.0005839055769774, 0.002943420301049,
            0.002289557632331,-0.0006509351861409,-0.002514446938326,-0.001160670822436,
            0.001856421267704, 0.003059141560145, 0.001041887956052,-0.001900333755769,
            -0.002396071092346, 0.000125908002983, 0.002764251209141, 0.002469246771947,
            -0.0004465489288814,-0.002651184374295,-0.001615401142555, 0.001471267448811,
            0.003052228490403, 0.001286420978738, -0.00182256080445,-0.002715312720606,
            -0.0003665294219697, 0.002521572462109, 0.002613093544803,-0.0002249107618352,
            -0.002753133607702,-0.002073724531509, 0.001032442507669, 0.002986710299279,
            0.001519528690932,-0.001711298978116,-0.003009588148958,-0.0008865837488904,
            0.002215199015582,  0.00271482542339,9.635265719018e-06,-0.002817167856453,
            -0.002527779434062, 0.000543539338727,  0.00285927441507,  0.00173467584631,
            -0.001567939056335,-0.003273647518051,-0.001427981589767, 0.001844966556393,
            0.002768815059342,0.0002528328074396,-0.002839811712975,  -0.0029697842764,
            9.631010060645e-06, 0.002666794109171, 0.001925609990084,-0.001393895503351,
            -0.003500841607938,-0.001982682477034, 0.001412897371063, 0.002769627718473,
            0.0004994775878654,-0.002819816340469,-0.003391793843282,-0.000563912832052,
            0.002407643122805, 0.002086428928825,-0.001191082343671,-0.003685859869034,
            -0.002542672235826,0.0009211950582774, 0.002712668974693,0.0007445636746588,
            -0.002754630061669,-0.003785573072868,-0.001170123478045, 0.002080442936336,
            0.002210722976553,-0.0009623156893971,-0.003822894977714,-0.003098898420586,
            0.0003735563138959, 0.002593137475983,0.0009819026016265,-0.002643981666451,
            -0.004142969149181,-0.001801502028602, 0.001684802518376,  0.00229178989656,
            -0.0007116195922971,-0.003907669661842,-0.003642073744291,-0.000224947741615,
            0.002408056040272, 0.001205509572762,-0.002487459899938,-0.004456153877544,
            -0.002449715607142, 0.001222028351717, 0.002324239362759,-0.0004425799581652,
            -0.003935446386575,-0.004162660019388,-0.0008691100122036, 0.002153694386671,
            0.00140869826805,-0.002285803493012,-0.004716972188967,-0.003105348281169,
            0.0006936970836751, 0.002301963942493,-0.0001602515017313,-0.003902641681608,
            -0.004650629736163,-0.001552036252898, 0.001828193150749, 0.001585013826794,
            -0.00204008287386,-0.004917807127917, -0.00375892701699,0.0001021764055677,
            0.00221937075463,0.0001300598980058,-0.003805894081822,-0.005095829024629,
            -0.002266410113298, 0.001429097761728, 0.001727153508451,-0.001752556581997,
            -0.005051296408214,-0.004399748865474,-0.0005488275409023, 0.002070994022419,
            0.0004225487560221,-0.003642745890099,-0.005487845014178,-0.003003842646996,
            0.0009559136777633, 0.001828443543543, -0.00142534595479,-0.005110117762274,
            -0.005017024638435,-0.001255293929671, 0.001851911556297,0.0007109925846559,
            -0.003410890242278,-0.005816743688134,-0.003755874255016,0.0004071291916731,
            0.001881524958874,-0.001061374729191,-0.005086972905153,-0.005599713083658,
            -0.002012788815634, 0.001556374136611,0.0009887564632421,-0.003108135413661,
            -0.006071059253961,-0.004512934670505,-0.000217529484314, 0.001878577931431,
            -0.0006643298137598,-0.004974968115998,-0.006135911168797,-0.002816451890152,
            0.0011794482434, 0.001248665300666,-0.002732673402175,-0.006240336508947,
            -0.005265609517258,-0.0009192505759923, 0.001811734675847,-0.0002373267182277,
            -0.004765992895837,-0.006613416900163,-0.003661493946237,0.0007146896599725,
            0.001483419185492,-0.002281967019704,-0.006312004682226,-0.006003923469188,
            -0.00169951575705,   0.0016719799995,0.0002162530769538,-0.004451555433545,
            -0.007019270067106,-0.004544178720113,0.0001544631565457, 0.001684856056908,
            -0.001752444246614, -0.00627298303397,-0.006718394216049,-0.002562285146046,
            0.001448375075262,0.0006937126111081,-0.004020105223267,-0.007339058594904,
            -0.005461716414471,-0.0005117499381101, 0.001844173379904, -0.00113802432258,
            -0.006106327664299,-0.007399079319911,-0.003514487390929, 0.001127263372933,
            0.001193388512466,-0.003456490658828,-0.007556095220509,-0.006414418756424,
            -0.001299462052173,  0.00195078806757,-0.0004287344023538,-0.005790708226363,
            -0.008036802101073,-0.004569119793124, 0.000690192268655,   0.0017162283585,
            -0.00273747027843, -0.00764995535661,-0.007407927356392,-0.002233507490579,
            0.001992224099292,0.0003939744392533,-0.005294315640129,-0.008622711563859,
            -0.005751337721764,0.0001080810384171, 0.002266877112448,-0.001825843297206,
            -0.00759181912535,-0.008456860477196,-0.003355950894145, 0.001950329929003,
            0.001362862287481,-0.004567509663448,-0.009148553131949,-0.007107209129425,
            -0.0006657500156799, 0.002858173585101,-0.0006559805513201,-0.007337491254214,
            -0.009593846900411,-0.004742865500432, 0.001797809890477, 0.002541209122407,
            -0.003522256610054,-0.009606873618314,-0.008727524610163,-0.001717852519509,
            0.003518895092462, 0.000896303534449,-0.006808703739253, -0.01089014456658,
            -0.006544486569958, 0.001484455801025, 0.004058422652675,-0.001985299395906,
            -0.009991156091384, -0.01080483131482,-0.003225035967247, 0.004315495940529,
            0.003097799036103,-0.005843257856115, -0.01251011243545,-0.009096955449728,
            0.0009031461900017, 0.006215233319568,0.0004429546573388, -0.01029617848418,
            -0.01380889261707,-0.005619391078466, 0.005420675911101, 0.006627802950975,
            -0.004027741406587, -0.01490130587886, -0.01331639203996,-0.000239180645121,
            0.009876594466964, 0.004931567954256, -0.01051696383452, -0.01921222544401,
            -0.01028814608981, 0.007419074676994,  0.01384171004203,0.0001173976610277,
            -0.01976468344948, -0.02282746701487,-0.003151407790547,  0.01886003302461,
            0.01695071318607, -0.01065098601292, -0.03500860035355,  -0.0254242640001,
            0.01413739279817,  0.04194700340292,  0.01892887738654, -0.04383760460868,
            -0.08121461095338, -0.02677926125697,   0.1211226221272,   0.2829036114225,
            0.3529405926329,   0.2829036114225,   0.1211226221272, -0.02677926125697,
            -0.08121461095338, -0.04383760460868,  0.01892887738654,  0.04194700340292,
            0.01413739279817,  -0.0254242640001, -0.03500860035355, -0.01065098601292,
            0.01695071318607,  0.01886003302461,-0.003151407790547, -0.02282746701487,
            -0.01976468344948,0.0001173976610277,  0.01384171004203, 0.007419074676994,
            -0.01028814608981, -0.01921222544401, -0.01051696383452, 0.004931567954256,
            0.009876594466964,-0.000239180645121, -0.01331639203996, -0.01490130587886,
            -0.004027741406587, 0.006627802950975, 0.005420675911101,-0.005619391078466,
            -0.01380889261707, -0.01029617848418,0.0004429546573388, 0.006215233319568,
            0.0009031461900017,-0.009096955449728, -0.01251011243545,-0.005843257856115,
            0.003097799036103, 0.004315495940529,-0.003225035967247, -0.01080483131482,
            -0.009991156091384,-0.001985299395906, 0.004058422652675, 0.001484455801025,
            -0.006544486569958, -0.01089014456658,-0.006808703739253, 0.000896303534449,
            0.003518895092462,-0.001717852519509,-0.008727524610163,-0.009606873618314,
            -0.003522256610054, 0.002541209122407, 0.001797809890477,-0.004742865500432,
            -0.009593846900411,-0.007337491254214,-0.0006559805513201, 0.002858173585101,
            -0.0006657500156799,-0.007107209129425,-0.009148553131949,-0.004567509663448,
            0.001362862287481, 0.001950329929003,-0.003355950894145,-0.008456860477196,
            -0.00759181912535,-0.001825843297206, 0.002266877112448,0.0001080810384171,
            -0.005751337721764,-0.008622711563859,-0.005294315640129,0.0003939744392533,
            0.001992224099292,-0.002233507490579,-0.007407927356392, -0.00764995535661,
            -0.00273747027843,   0.0017162283585, 0.000690192268655,-0.004569119793124,
            -0.008036802101073,-0.005790708226363,-0.0004287344023538,  0.00195078806757,
            -0.001299462052173,-0.006414418756424,-0.007556095220509,-0.003456490658828,
            0.001193388512466, 0.001127263372933,-0.003514487390929,-0.007399079319911,
            -0.006106327664299, -0.00113802432258, 0.001844173379904,-0.0005117499381101,
            -0.005461716414471,-0.007339058594904,-0.004020105223267,0.0006937126111081,
            0.001448375075262,-0.002562285146046,-0.006718394216049, -0.00627298303397,
            -0.001752444246614, 0.001684856056908,0.0001544631565457,-0.004544178720113,
            -0.007019270067106,-0.004451555433545,0.0002162530769538,   0.0016719799995,
            -0.00169951575705,-0.006003923469188,-0.006312004682226,-0.002281967019704,
            0.001483419185492,0.0007146896599725,-0.003661493946237,-0.006613416900163,
            -0.004765992895837,-0.0002373267182277, 0.001811734675847,-0.0009192505759923,
            -0.005265609517258,-0.006240336508947,-0.002732673402175, 0.001248665300666,
            0.0011794482434,-0.002816451890152,-0.006135911168797,-0.004974968115998,
            -0.0006643298137598, 0.001878577931431,-0.000217529484314,-0.004512934670505,
            -0.006071059253961,-0.003108135413661,0.0009887564632421, 0.001556374136611,
            -0.002012788815634,-0.005599713083658,-0.005086972905153,-0.001061374729191,
            0.001881524958874,0.0004071291916731,-0.003755874255016,-0.005816743688134,
            -0.003410890242278,0.0007109925846559, 0.001851911556297,-0.001255293929671,
            -0.005017024638435,-0.005110117762274, -0.00142534595479, 0.001828443543543,
            0.0009559136777633,-0.003003842646996,-0.005487845014178,-0.003642745890099,
            0.0004225487560221, 0.002070994022419,-0.0005488275409023,-0.004399748865474,
            -0.005051296408214,-0.001752556581997, 0.001727153508451, 0.001429097761728,
            -0.002266410113298,-0.005095829024629,-0.003805894081822,0.0001300598980058,
            0.00221937075463,0.0001021764055677, -0.00375892701699,-0.004917807127917,
            -0.00204008287386, 0.001585013826794, 0.001828193150749,-0.001552036252898,
            -0.004650629736163,-0.003902641681608,-0.0001602515017313, 0.002301963942493,
            0.0006936970836751,-0.003105348281169,-0.004716972188967,-0.002285803493012,
            0.00140869826805, 0.002153694386671,-0.0008691100122036,-0.004162660019388,
            -0.003935446386575,-0.0004425799581652, 0.002324239362759, 0.001222028351717,
            -0.002449715607142,-0.004456153877544,-0.002487459899938, 0.001205509572762,
            0.002408056040272,-0.000224947741615,-0.003642073744291,-0.003907669661842,
            -0.0007116195922971,  0.00229178989656, 0.001684802518376,-0.001801502028602,
            -0.004142969149181,-0.002643981666451,0.0009819026016265, 0.002593137475983,
            0.0003735563138959,-0.003098898420586,-0.003822894977714,-0.0009623156893971,
            0.002210722976553, 0.002080442936336,-0.001170123478045,-0.003785573072868,
            -0.002754630061669,0.0007445636746588, 0.002712668974693,0.0009211950582774,
            -0.002542672235826,-0.003685859869034,-0.001191082343671, 0.002086428928825,
            0.002407643122805,-0.000563912832052,-0.003391793843282,-0.002819816340469,
            0.0004994775878654, 0.002769627718473, 0.001412897371063,-0.001982682477034,
            -0.003500841607938,-0.001393895503351, 0.001925609990084, 0.002666794109171,
            9.631010060645e-06,  -0.0029697842764,-0.002839811712975,0.0002528328074396,
            0.002768815059342, 0.001844966556393,-0.001427981589767,-0.003273647518051,
            -0.001567939056335,  0.00173467584631,  0.00285927441507, 0.000543539338727,
            -0.002527779434062,-0.002817167856453,9.635265719018e-06,  0.00271482542339,
            0.002215199015582,-0.0008865837488904,-0.003009588148958,-0.001711298978116,
            0.001519528690932, 0.002986710299279, 0.001032442507669,-0.002073724531509,
            -0.002753133607702,-0.0002249107618352, 0.002613093544803, 0.002521572462109,
            -0.0003665294219697,-0.002715312720606, -0.00182256080445, 0.001286420978738,
            0.003052228490403, 0.001471267448811,-0.001615401142555,-0.002651184374295,
            -0.0004465489288814, 0.002469246771947, 0.002764251209141, 0.000125908002983,
            -0.002396071092346,-0.001900333755769, 0.001041887956052, 0.003059141560145,
            0.001856421267704,-0.001160670822436,-0.002514446938326,-0.0006509351861409,
            0.002289557632331, 0.002943420301049,0.0005839055769774,-0.002059271433199,
            -0.001945343513852,0.0007913827948186, 0.003012144946458, 0.002185083457686,
            -0.000716388253454,-0.002347076373794,-0.000835302343748, 0.002080070531093,
            0.003060904401584, 0.001002782286197,-0.001710834683023,-0.001957986292545,
            0.0005403626683759, 0.002915932180707, 0.002456124166766,-0.0002885566081148,
            -0.00215284343431,-0.0009967446947021, 0.001846697604527, 0.003118495991565,
            0.001377653290532,-0.001356966370048,-0.001938982042832,0.0002942203066712,
            0.002776050905555, 0.002668323464394, 0.000115971513545,-0.001936293595966,
            -0.001132875304044, 0.001596656562541, 0.003120594006668, 0.001705833281049,
            -0.00100387894099,-0.001890684790081,5.738478820192e-05, 0.002598055402464,
            0.002822638834225, 0.000492521179174,-0.001702619667215,-0.001243110511869,
            0.001334713539235,  0.00306997573009, 0.001984152340229,-0.0006576011235634,
            -0.001814918540032,-0.0001658494867988, 0.002388546811447, 0.002920512312743,
            0.0008363869868532,-0.001456684845825,-0.001326318717331, 0.001067357195083,
            0.002972423717744, 0.002212219040436,-0.000322685377187,-0.001714677543657,
            -0.0003720503258406, 0.002153126000497, 0.002963904631466, 0.001144188808004,
            -0.001202796193306,-0.001382416440293,0.0008002456661286, 0.002832244561842,
            0.002388868154202,-5.001540654943e-06,-0.001592610050418,-0.0005583641440937,
            0.001898422754825, 0.002955873757237, 0.001412577491897,-0.0009460778582013,
            -0.001411281156302,0.0005388602928766, 0.002656047750177, 0.002514436733226,
            0.0002911964638295,-0.001453255880003,-0.0007225827614733,  0.00163061212209,
            0.002900608348029, 0.001639371892151,-0.0006916848664123,-0.001415711070507,
            0.0002866811880138, 0.002448962032239, 0.002591176103359,0.0005628978549067,
            -0.001298511715362,-0.0008625639463818, 0.001355356433184, 0.002802211625707,
            0.001824200382772,-0.0004427996696732, -0.00139459657493,4.910911741414e-05,
            0.002217334927419, 0.002619836627284,0.0008059588084943,-0.001133317449416,
            -0.0009776325870512, 0.001078934603064, 0.002665741286797, 0.001966319818918,
            -0.0002042041204964,-0.001351830516465,-0.0001714913720807, 0.001966427446464,
            0.002603907835322, 0.001018500447534,-0.0009607232971101,-0.001066626862007,
            0.0008062205022658, 0.002496103148924, 0.002065892673452,2.038798429254e-05,
            -0.001289133976047,-0.0003711971095995, 0.001703352037608, 0.002547165636547,
            0.001198769714843,-0.0007847485843289,-0.001131133114485,0.0005416988011997,
            0.002298983764104, 0.002124287145477,0.0002281928410587,-0.001209304369199,
            -0.000548683060316, 0.001433713409129, 0.002454282791398, 0.001347297789009,
            -0.0006080825633426,-0.001170209564429, 0.000289859042798, 0.002080237356164,
            0.002144325138744,0.0004172499015883,-0.001114281644621,-0.0007024018759254,
            0.001161722365007, 0.002327491425921, 0.001460854309668,-0.0004348973290381,
            -0.001185755267068,5.462044923736e-05,  0.00184550238704, 0.002126808893493,
            0.0005832441281812,-0.001008451135744,-0.0008304690105332,0.0008948555054185,
            0.00217481402121, 0.001542122521716,-0.000268894207009,-0.001180665464799,
            -0.000161382341586, 0.001600316665001, 0.002077432482601,0.0007275022188495,
            -0.0008931039706657,-0.0009330229645816,0.0006359702914323, 0.001998770663449,
            0.001590729081188,-0.0001120293655498,-0.001154784847737,-0.0003553876318224,
            0.001351131421487,   0.0019977879338,0.0008476673993606,-0.0007729608274546,
            -0.001010101112361,0.0003901943336624, 0.001805952340056, 0.001610034189391,
            3.462079953838e-05,-0.001110988025465,-0.0005245627813242, 0.001101311125526,
            0.001891232909568,0.0009419884988638,-0.0006503799072428,-0.001063635211024,
            0.000160029178462, 0.001599026219155, 0.001599128455241,0.0001664110523444,
            -0.001051074846744,-0.0006686976588048,0.0008573197236253, 0.001763195689928,
            0.001012332601044,-0.0005268925468379,-0.001091777149229,-4.860219563733e-05,
            0.001386727109692, 0.001562946144034,0.0002837007988668,-0.0009799357305845,
            -0.000786794555006,0.0006233053467681, 0.001619257907855, 0.001059864779588,
            -0.0004066049191761,-0.001099553955996,-0.0002383566124884, 0.001171363240457,
            0.001505423704026, 0.000386722646621,-0.0008962587217069,-0.0008799323852014,
            0.0003989432641414,  0.00145922491158, 0.001083599833506,-0.0002897189544568,
            -0.001084182337297,-0.0004010096586872,0.0009583933614704,  0.00142659300286,
            0.0004706659912408,-0.0008074562481527,-0.0009485187898888,0.0001932837727615,
            0.001291523031235, 0.001086757239231,-0.0001820666339966, -0.00105368887147,
            -0.0005419160355687,0.0007503892457431, 0.001332525630582,0.0005386894289782,
            -0.000712179315127,-0.000989248813609,9.411383095182e-06, 0.001124368591935,
            0.001073071901619,-7.997294061715e-05,-0.001007733027611,-0.0006552526642231,
            0.0005556846473875, 0.001225996935594,0.0005895409352301,-0.0006172987407817,
            -0.001011858494658,-0.0001545054438914, 0.000955849541291, 0.001040750392679,
            9.173374464842e-06,-0.0009504685916628,-0.0007452284318538,0.0003740172819325,
            0.001112288115912, 0.000624818659927,-0.0005228098314979,-0.001012844154203,
            -0.0002963541451266,0.0007911046221082,0.0009951662529362,8.847585094435e-05,
            -0.0008804045750915,-0.0008103334986364,0.0002112234245112,0.0009903183505023,
            0.000640869627591,-0.0004307328547646, -0.00099124261468,-0.0004054467855659,
            0.0006405533550184,0.0009331479693329, 0.000143064449299,-0.0008174477312983,
            -0.0008467104533838,7.737424922009e-05,0.0008884250969823,0.0006539565903338,
            -0.0003470224773931,-0.0009625668540147,-0.0004917351761826, 0.000506598535416,
            0.0008785601751685,0.0001967437535679,-0.0007468180885898,-0.0008719377005756,
            -4.159983599533e-05,0.0007752995892076,0.0006400627250246,-0.0002906878027679,
            -0.0009355366118545,-0.0005613267449677,0.0003981029005414, 0.000819277565379,
            0.0002327909966191,-0.0006997115177725,-0.0008754192541115,-0.0001192163039461,
            0.0006960687735884, 0.000635209998804,-0.0002549374502535,-0.000918535951082,
            -0.0005922282470676,0.0003398504045031,0.0007884515676214,0.0002351824726088,
            -0.0006857854984845,-0.0008952759700453,-0.0001416156350387,0.0006995152034379,
            0.0006272378730493,-0.0002869845199696,-0.0009728895412723,-0.0006025337000374,
            0.0004067627742961,0.0008619009340159,0.0001843095076105,-0.0008586680779745,
            -0.001012654016707,-1.459276108929e-05,0.0009978027936497,0.0007487101716253,
            -0.0006300203697085,-0.001553460279354,-0.0007058348021241, 0.001285245698351,
            0.002122811180409,4.897548738224e-05,-0.004200439609664,-0.007730992967857,
            -0.02150272516411
    };

    public static float[] applyBandpassFilter(float[] audio)
    {
        return applyFIRFilter(audio, bandpass_16k);
    }

    public static float[] applyLowpassFilter(float[] audio)
    {
        return applyFIRFilter(audio, lowpass_8k);
    }

    private static float[] applyFIRFilter(float[] input, double[] impulse_response)
    {
        // Variables used for applying filtering
        int length = impulse_response.length;
        float[] delay_line = new float[length];
        int count = 0;

        // Final return variable
        float[] output = new float[input.length];

        for (int i = 0; i < input.length; i++)
        {
            output[i] = getOutputSample(input[i], length, delay_line, impulse_response, count);
        }

        return output;
    }

    private static float getOutputSample(float input_sample, int length, float[] delay_line, double[] impulse_response, int count)
    {
        delay_line[count] = input_sample;
        float result = 0.0f;
        int index = count;
        for (int i=0; i<length; i++)
        {
            result += impulse_response[i] * delay_line[index--];
            if (index < 0) index = length-1;
        }
        if (++count >= length)
        {
            count = 0;
        }
        return result;
    }
}
